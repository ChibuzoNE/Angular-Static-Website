- name: Create MariaDB database
  community.mysql.mysql_db:
    name: "{{ mariadb_database }}"
    state: present
    login_unix_socket: /var/run/mysqld/mysqld.sock

- name: Create MariaDB user
  community.mysql.mysql_user:
    name: "{{ mariadb_username }}"
    password: "{{ mariadb_password }}"
    priv: "{{ mariadb_db_name }}.*:ALL"
    host: "{{ mariadb_host }}"
    state: present
    login_unix_socket: /var/run/mysqld/mysqld.sock

 # Step 0: Copy sample data file to the target host if not exists
- name: Copy sample data file to target server
  copy:
    src: //home/ec2-user/Angular-Static-Website/sample-data/contact-data.sql
    dest: /tmp/sample_data.sql
    mode: '0644'
  when: not sample_data_file.stat.exists


- name: Check if sample data file exists
  stat:
    path: /tmp/sample_data.sql
  register: sample_data_file

- name: Import sample data (if available)
  community.mysql.mysql_db:
    name: "{{ mariadb_database }}"
    state: import
    target: /tmp/sample_data.sql
    login_unix_socket: /var/run/mysqld/mysqld.sock